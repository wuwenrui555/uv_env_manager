# Environment Manager using `uv`

`uv` is a fast Python package installer and resolver, written in Rust. This project demonstrates how to manage Python environments using `uv`.

## Installation

First, install `uv` if you haven't already:

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

## File Structure of uv Environment

```tree
uv_env/                   # Root directory for all environments
├── uv_mesmer/            # Project-specific directory
│   ├── .venv/            # Virtual environment directory
│   ├── pyproject.toml    # Project definition and dependencies
│   └── uv.lock           # Lock file with exact package versions
```

### Key Components Explained

1. **Root directory (`uv_env/`)**:
   - Central location for storing multiple `uv` environments
   - Typically placed in a shared location (e.g., `/mnt/nfs/storage/`)
   - Can contain multiple project environments for different applications

2. **Project directory (`uv_mesmer/`)**:
   - Named after your specific project
   - Contains everything needed for that project's environment
   - Multiple projects can exist under the same root directory

3. **Virtual environment (`.venv/`)**:
   - Created with the `uv init` and `uv add` command
   - Contains isolated Python installation with its own packages
   - Independent from system Python and other environments

4. **Configuration files**:
   - `pyproject.toml`: Modern Python project configuration that defines dependencies
   - `uv.lock`: Generated by `uv` to record exact versions for reproducibility

This structure allows for centralized management while enabling sharing environments across projects through symbolic links or direct referencing.

## Using `uv` Virtual Environment Options

### Option 1: Create Symbolic Links (Read-Only Access)

Create symbolic links to an existing environment (you cannot modify the environment directly):

```bash
cd /path/to/your/project
venv_name=uv_mesmer
ln -s /mnt/nfs/storage/uv_env/${venv_name}/.venv .
ln -s /mnt/nfs/storage/uv_env/${venv_name}/pyproject.toml .
ln -s /mnt/nfs/storage/uv_env/${venv_name}/uv.lock .

# Run your script using the linked environment
uv run python your_script.py
```

### Option 2: Copy the Environment (Full Access)

Copy an existing environment to your local project (you can modify the environment directly):

```bash
cd /path/to/your/project
venv_name=uv_mesmer
cp -r /mnt/nfs/storage/uv_env/${venv_name}/.venv .
cp /mnt/nfs/storage/uv_env/${venv_name}/pyproject.toml .
cp /mnt/nfs/storage/uv_env/${venv_name}/uv.lock .

# Run your script using the copied environment
uv run python your_script.py
```

### Option 3: Reference External Environment

Run scripts using an environment from its original location without copying or linking:

```bash
# Use the --no-project flag to ignore local project settings
# Use -p to specify the path to the virtual environment
venv_path=/mnt/nfs/storage/uv_env/uv_mesmer/.venv
uv run --no-project -p ${venv_path} python your_script.py
```

## Advanced Usage

### Activating the Environment

Activate the environment in your shell (similar to traditional virtual env):

```bash
# Activate the environment
source .venv/bin/activate

# Run commands directly without uv run
python your_script.py

# Deactivate when finished
deactivate
```

## Advantages of Using `uv`

- **Speed**: Faster package installations compared to pip (up to 10-100x)
- **Reliability**: Better dependency resolution to avoid conflicts
- **Compatibility**: Works with existing Python projects and tools
- **Performance**: Written in Rust for improved efficiency
- **Centralization**: Easy to manage multiple environments in one location

## Existing Environments

```tree
# Environment for segmentation using Mesmer
/mnt/nfs/storage/uv_env/
├── uv_mesmer/
├── uv_valis/
```

### `uv_mesmer`: Segmentation using Mesmer

<https://github.com/wuwenrui555/uv_mesmer>

### `uv_valis`: Alignment using Valis

<https://github.com/wuwenrui555/uv_valis>
